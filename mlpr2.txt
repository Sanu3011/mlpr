import pandas as pd
import seaborn as sns
import numpy as np
import matplotlib.pyplot as plt

df = pd.read_csv("temperatures.csv")
df

df.head()

df.tail()

top_5_data = df.nlargest(5,'JAN')
top_5_data

plt.figure(figsize=(15,12))
plt.title("Top 5 Records")
sns.barplot(x=top_5_data.YEAR,y=top_5_data.JAN)

from sklearn.model_selection import train_test_split
X = df[['YEAR']]
y = df[['JAN']]

x_train, x_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=1)

from sklearn import linear_model
from sklearn.metrics import r2_score

lm = linear_model.LinearRegression()
m = lm.fit(x_train, y_train)
y_preds = lm.predict(x_test)
print("Predicted Response : ",y_preds)

print("Intercept : ",lm.intercept_)
print("Slope : ",lm.coef_)

MSE = np.square(np.subtract(y_test,y_preds)).mean()
from sklearn.metrics import mean_absolute_error
MAE=mean_absolute_error(y_test,y_preds)
import math
RMSE = (math.sqrt(MSE))
print("Mean Absolute Error : ",MAE)
print("Mean Squared Error : ",MSE)
print("Root Mean Squared Error : ",RMSE)

r2score = r2_score(y_test,y_preds)
r2score

plt.scatter(x_test,y_test,color='blue')
plt.plot(x_test,y_test,lm.predict(x_test),color='black',linewidth=1)
plt.title("Temperature Vs Year")
plt.xlabel("YEAR")
plt.ylabel("Temperature")
plt.show()


plt.scatter(x_train,y_train,color='red')
plt.plot(x_train,lm.predict(x_train),color='black',linewidth=3)
plt.title("Temperature Vs Year")
plt.xlabel("YEAR")
plt.ylabel("Temperature")
plt.show()
